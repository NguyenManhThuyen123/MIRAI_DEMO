import{_ as O}from"./BwQZSwmj.js";import{_ as T,f as Q,u as $,r as p,g as j,o as f,c as I,b as H,a as c,i as J,t as S,F as P,x as K,N as x,n as D,K as M}from"./DAaR74PX.js";import{a as g}from"./B4uVmeYG.js";var a=[];for(var b=0;b<256;++b)a.push((b+256).toString(16).slice(1));function G(e,t=0){return(a[e[t+0]]+a[e[t+1]]+a[e[t+2]]+a[e[t+3]]+"-"+a[e[t+4]]+a[e[t+5]]+"-"+a[e[t+6]]+a[e[t+7]]+"-"+a[e[t+8]]+a[e[t+9]]+"-"+a[e[t+10]]+a[e[t+11]]+a[e[t+12]]+a[e[t+13]]+a[e[t+14]]+a[e[t+15]]).toLowerCase()}var q,W=new Uint8Array(16);function X(){if(!q&&(q=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!q))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return q(W)}var Y=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const R={randomUUID:Y};function Z(e,t,U){if(R.randomUUID&&!t&&!e)return R.randomUUID();e=e||{};var o=e.random||(e.rng||X)();return o[6]=o[6]&15|64,o[8]=o[8]&63|128,G(o)}const ee={class:"quiz-container"},te={class:"quiz-body"},se=["src"],ae={class:"question-text"},oe={class:"question-name"},ne={class:"answers"},re=["onClick"],ie={__name:"question",setup(e){const t=Q(),U=$(),o=p({}),l=p([]),v=p(""),_=p(null),h=p(0);let C=p([]),d=JSON.parse(localStorage.getItem("results"))||[],k=localStorage.getItem("user_id")||Z();localStorage.setItem("user_id",k);const N=async s=>{x.start(),x.set(.4);try{const[n,m,u]=await Promise.all([g.get("https://naadstkfr7.execute-api.ap-southeast-1.amazonaws.com/questions"),g.get(`https://naadstkfr7.execute-api.ap-southeast-1.amazonaws.com/questions/${s.value}`),g.get(`https://naadstkfr7.execute-api.ap-southeast-1.amazonaws.com/mirai-answers-lambda/${s.value}`)]);o.value=m.data,l.value=u.data,h.value=n.data.length,C=n.data.map(i=>i.id),console.log(C)}catch(n){console.error("Error fetching question:",n)}finally{x.done()}};function V(s){if(_.value!==null)return;_.value=s;const n=l.value[s].is_correct,m={id:v.value,status:n};d.push(m),setTimeout(async()=>{const i=d.reduce((r,w)=>(r[w.id]=w.status,r),{}),A=[{id:k,log_answer:i}];try{await g.post("https://naadstkfr7.execute-api.ap-southeast-1.amazonaws.com/mirai-analysis-lambda",A)}catch(r){console.error("Error posting analysis data:",r)}const z=d.length;let B="https://naadstkfr7.execute-api.ap-southeast-1.amazonaws.com/mirai-statistic-lambda",y={};if(z===1?y={status:0}:z===h.value&&(y={status:1}),Object.keys(y).length>0)try{await g.post(B,y)}catch(r){console.error("Error posting statistic data:",r)}if(n)t.push({path:"/users/questionCorrect",query:{answer:String.fromCharCode(65+s),content:l.value[s].content,explain:o.value.content,explainImg:o.value.image_explain,questionsCount:h.value}});else{const r=l.value.findIndex(w=>w.is_correct);t.push({path:"/users/questionIncorrect",query:{answer:String.fromCharCode(65+s),content:l.value[s].content,correctAnswer:String.fromCharCode(65+r),correctAnswerContent:l.value[r].content,explain:o.value.content,explainImg:o.value.image_explain,questionsCount:h.value}})}const F=d.filter(r=>C.includes(parseInt(r.id,10)));localStorage.setItem("results",JSON.stringify(F))},3e3);const u=document.querySelectorAll(".answer-option button")[s];u&&(u.classList.add("hover-animation"),setTimeout(()=>{u.classList.remove("hover-animation")},3e3))}const L=s=>"https://mirai-static-website.s3.ap-southeast-1.amazonaws.com/"+s,E=()=>new Date().toISOString().split("T")[0];return j(()=>{v.value=U.query.id;const s=E(),n=localStorage.getItem("is_first_login");n?n!==s&&(localStorage.setItem("is_first_login",s),localStorage.removeItem("results"),ư,localStorage.removeItem("user_id"),d=[]):localStorage.setItem("is_first_login",s),d.some(u=>u.id===v.value)?(alert("この問題にはすでに回答しました。"),t.push("/users/questionResult")):N(v)}),(s,n)=>{const m=O;return f(),I("div",ee,[H(m,{admin:!0}),c("div",te,[o.value.image_question?(f(),I("img",{key:0,src:L(o.value.image_question)},null,8,se)):J("",!0),c("div",ae,[c("h2",null,"問題"+S(o.value.sort)+":",1)]),c("p",oe,S(o.value.title),1),c("div",ne,[(f(!0),I(P,null,K(l.value,(u,i)=>(f(),I("div",{class:D(["answer-option",{selected:_.value===i}]),key:i,onClick:A=>V(i)},[c("button",{class:D("option-"+String.fromCharCode(65+i)),style:M({transform:_.value===i?"scale(1.2)":""})},S(String.fromCharCode(65+i)),7),c("p",null,S(u.content),1)],10,re))),128))])])])}}},de=T(ie,[["__scopeId","data-v-ce3600e4"]]);export{de as default};
